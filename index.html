<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trip Manager - Firebase Realtime DB</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <style>
        /* Custom scrollbar for better UI */
        .overflow-y-auto::-webkit-scrollbar {
            width: 8px;
        }
        .overflow-y-auto::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .overflow-y-auto::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .overflow-y-auto::-webkit-scrollbar-thumb:hover {
            background: #555;
            border-radius: 10px;
        }
        @media print {
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // üõë 1. FIREBASE CONFIGURATION üõë
        const firebaseConfig = {
            apiKey: "AIzaSyB5hybGUq4ZhGQJeTW-Rha9hMj8hF6ohR0",
            authDomain: "trip-2611b.firebaseapp.com",
            databaseURL: "https://trip-2611b-default-rtdb.firebaseio.com", // Ensure this is correct
            projectId: "trip-2611b",
            storageBucket: "trip-2611b.firebasestorage.app",
            messagingSenderId: "429060121850",
            appId: "1:429060121850:web:2bc76200815f4be5b59543",
            measurementId: "G-1ENGW43YXT"
        };

        // Initialize Firebase App
        const app = firebase.initializeApp(firebaseConfig);
        
        // üõ†Ô∏è RTDB CHANGE 1: Initialize the Realtime Database
        const db = app.database(); 
        
        // üõ†Ô∏è RTDB CHANGE 2: Define Realtime Database references (path to the data)
        const travelersRef = db.ref("travelers");
        const expensesRef = db.ref("expenses");
        
        // Initial Data (only used if Firebase collections are empty)
        const initialTravelers = [
            { id: 't1', name: 'John Doe', transport: 'Plane', arrival: 'Nov 26', departure: 'Nov 30', status: 'Confirmed' },
            { id: 't2', name: 'Jane Smith', transport: 'Train', arrival: 'Nov 27', departure: 'Dec 01', status: 'Confirmed' },
            // ... (rest of initial travelers)
        ];
        const initialExpenses = [
            { id: 'e1', date: 'Nov 25', description: 'Accommodation Deposit', amount: 6000, splitType: 'Equal', paidBy: 'Sarah Lee', status: 'Confirmed' },
            // ... (rest of initial expenses)
        ];

        // Helper to format date for input defaults (remains the same)
        const getFormattedDate = (date) => {
            const d = date ? new Date(date) : new Date();
            const month = d.toLocaleString('en-US', { month: 'short' });
            const day = d.getDate().toString().padStart(2, '0');
            return `${month} ${day}`;
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('travelers');
            const [travelers, setTravelers] = useState([]);
            const [expenses, setExpenses] = useState([]);
            const [loading, setLoading] = useState(true);

            // üõ†Ô∏è RTDB CHANGE 3: Realtime Data Fetch (replaces onSnapshot)
            useEffect(() => {
                const travelersListener = travelersRef.on('value', snapshot => {
                    const travelerObject = snapshot.val() || {};
                    // RTDB returns an object, we convert it to an array, using the key as the ID
                    const travelerData = Object.entries(travelerObject).map(([key, value]) => ({ 
                        ...value, 
                        id: key 
                    }));
                    setTravelers(travelerData);
                    setLoading(false);
                }, error => {
                    console.error("Error fetching travelers:", error);
                    setLoading(false);
                });

                const expensesListener = expensesRef.on('value', snapshot => {
                    const expenseObject = snapshot.val() || {};
                    // Convert RTDB object to an array
                    const expenseData = Object.entries(expenseObject).map(([key, value]) => ({ 
                        ...value, 
                        id: key 
                    }));
                    setExpenses(expenseData);
                    setLoading(false);
                }, error => {
                    console.error("Error fetching expenses:", error);
                    setLoading(false);
                });

                // Cleanup subscription on component unmount (using RTDB .off())
                return () => {
                    travelersRef.off('value', travelersListener);
                    expensesRef.off('value', expensesListener);
                };
            }, []);
            
            if (loading) {
                return <div className="p-10 text-center text-xl font-semibold text-gray-600">Loading trip data from Firebase Realtime Database...</div>;
            }
            
            // üõ†Ô∏è RTDB CHANGE 4: Realtime Database CRUD Operations (replaces Firestore functions)
            
            // Traveler Handlers
            const addTraveler = async (newTraveler) => {
                try {
                    // RTDB: .push() is used to add data with a unique, automatically generated ID
                    await travelersRef.push(newTraveler); 
                } catch (e) {
                    console.error("Error adding traveler: ", e);
                }
            };

            const deleteTraveler = async (id) => {
                try {
                    // RTDB: .child(id).remove() deletes the node at that path
                    await travelersRef.child(id).remove(); 
                } catch (e) {
                    console.error("Error deleting traveler: ", e);
                }
            };

            const updateTravelerStatus = async (id, newStatus) => {
                try {
                    // RTDB: .child(id).update() updates specific properties of the node
                    await travelersRef.child(id).update({ status: newStatus }); 
                } catch (e) {
                    console.error("Error updating traveler: ", e);
                }
            };

            // Expense Handlers
            const addExpense = async (newExpense) => {
                try {
                    // RTDB: .push() is used to add data with a unique, automatically generated ID
                    await expensesRef.push(newExpense); 
                } catch (e) {
                    console.error("Error adding expense: ", e);
                }
            };

            const deleteExpense = async (id) => {
                try {
                    // RTDB: .child(id).remove() deletes the node at that path
                    await expensesRef.child(id).remove(); 
                } catch (e) {
                    console.error("Error deleting expense: ", e);
                }
            };
            
            // --- ALL OTHER COMPONENTS GO HERE (UNCHANGED LOGIC) ---

            const getStatusColor = (status) => {
                switch (status) {
                    case 'Confirmed': return 'bg-green-100 text-green-800';
                    case 'Pending': return 'bg-yellow-100 text-yellow-800';
                    case 'Cancelled': return 'bg-red-100 text-red-800';
                    default: return 'bg-gray-100 text-gray-800';
                }
            };

            // Expense Split Logic (Same as before)
            const calculateBalances = (confirmedTravelers, confirmedExpenses) => {
                const balances = {};
                confirmedTravelers.forEach(t => balances[t.name] = 0);
                const totalShares = {};
                confirmedTravelers.forEach(t => totalShares[t.name] = 0);

                confirmedExpenses.forEach(expense => {
                    const payerName = expense.paidBy;
                    if (!balances.hasOwnProperty(payerName)) return; 
                    
                    balances[payerName] += expense.amount;
                    
                    if (expense.splitType === 'Equal') {
                        const totalParticipants = confirmedTravelers.length;
                        const perShare = expense.amount / totalParticipants;
                        
                        confirmedTravelers.forEach(t => {
                            balances[t.name] -= perShare;
                            totalShares[t.name] += perShare;
                        });
                    }
                });

                const netBalances = Object.entries(balances)
                    .map(([name, netAmount]) => ({ name, netAmount }));

                const givers = netBalances.filter(b => b.netAmount < -0.01).sort((a, b) => a.netAmount - b.netAmount); 
                const receivers = netBalances.filter(b => b.netAmount > 0.01).sort((a, b) => b.netAmount - a.netAmount); 
                const settlements = [];

                let gIdx = 0;
                let rIdx = 0;

                while (gIdx < givers.length && rIdx < receivers.length) {
                    let giver = givers[gIdx];
                    let receiver = receivers[rIdx];

                    const amount = Math.min(Math.abs(giver.netAmount), receiver.netAmount);

                    settlements.push({
                        from: giver.name,
                        to: receiver.name,
                        amount: amount.toFixed(2),
                    });

                    giver.netAmount += amount;
                    receiver.netAmount -= amount;

                    if (giver.netAmount >= -0.01) gIdx++; 
                    if (receiver.netAmount <= 0.01) rIdx++; 
                }

                return { netBalances, settlements, totalShares };
            };


            const ExpenseSplitCalculator = () => {
                const confirmedTravelers = travelers.filter(t => t.status === 'Confirmed');
                const confirmedExpenses = expenses.filter(e => e.status === 'Confirmed');

                if (confirmedTravelers.length === 0) {
                    return <div className="p-4 bg-yellow-100 text-yellow-800 rounded-md">Please confirm at least one traveler to calculate splits.</div>;
                }
                
                const equalSplitExpenses = confirmedExpenses.filter(e => e.splitType === 'Equal');

                if (equalSplitExpenses.length === 0) {
                    return <div className="p-4 bg-blue-100 text-blue-800 rounded-md">No 'Equal Split' expenses have been confirmed to calculate settlement.</div>;
                }

                const { netBalances, settlements } = calculateBalances(confirmedTravelers, equalSplitExpenses);

                return (
                    <div className="bg-white p-6 rounded-lg shadow-md border border-gray-200 mb-6">
                        <h3 className="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            üí∞ Expense Settlement Breakdown
                        </h3>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            {/* Net Balances */}
                            <div className="bg-gray-50 p-4 rounded-lg shadow-sm">
                                <h4 className="font-semibold text-lg text-indigo-700 mb-3 border-b pb-2">Net Balances (Who owes whom)</h4>
                                <ul className="space-y-2">
                                    {netBalances.map((b, index) => (
                                        <li key={index} className="flex justify-between text-sm">
                                            <span>{b.name}</span>
                                            <span className={`font-mono font-bold ${b.netAmount > 0 ? 'text-green-600' : b.netAmount < 0 ? 'text-red-600' : 'text-gray-500'}`}>
                                                ‚Çπ{Math.abs(b.netAmount).toFixed(2)} {b.netAmount > 0 ? '(Owed)' : b.netAmount < 0 ? '(Owes)' : ''}
                                            </span>
                                        </li>
                                    ))}
                                </ul>
                                <p className="text-xs text-gray-500 mt-2">*Calculation based on **Confirmed** 'Equal Split' expenses.</p>
                            </div>

                            {/* Settlements */}
                            <div className="bg-gray-50 p-4 rounded-lg shadow-sm">
                                <h4 className="font-semibold text-lg text-purple-700 mb-3 border-b pb-2">Settlement Steps (Minimum Transfers)</h4>
                                <ul className="space-y-2">
                                    {settlements.length > 0 ? settlements.map((s, index) => (
                                        <li key={index} className="text-sm bg-purple-100 p-2 rounded-md">
                                            <span className="font-semibold">{s.from}</span> pays <span className="font-semibold">{s.to}</span> **‚Çπ{s.amount}**
                                        </li>
                                    )) : (
                                        <li className="text-sm text-gray-600">All balances are settled (or no common expenses recorded).</li>
                                    )}
                                </ul>
                            </div>
                        </div>
                    </div>
                );
            };

            const IndividualBillGenerator = () => {
                const confirmedTravelers = travelers.filter(t => t.status === 'Confirmed');
                const confirmedExpenses = expenses.filter(e => e.status === 'Confirmed');
                const [selectedTraveler, setSelectedTraveler] = useState('');
                const componentRef = useRef();

                const travelerName = selectedTraveler;

                const handlePrint = () => {
                    window.print();
                };

                if (confirmedTravelers.length === 0) {
                    return <div className="p-4 bg-yellow-100 text-yellow-800 rounded-md">Please confirm at least one traveler to generate a bill.</div>;
                }

                const travelerExpensesPaid = confirmedExpenses.filter(e => e.paidBy === travelerName);
                const totalPaid = travelerExpensesPaid.reduce((sum, exp) => sum + exp.amount, 0);

                const { totalShares } = calculateBalances(confirmedTravelers, confirmedExpenses);
                const totalOwedShare = totalShares[travelerName] || 0;

                const netBalance = totalPaid - totalOwedShare;

                return (
                    <div className="bg-gray-50 p-6 rounded-lg shadow-md border border-gray-200 mt-6 no-print">
                        <h3 className="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            üßæ Individual Bill Generator
                        </h3>
                        <div className="flex items-center space-x-4 mb-6">
                            <select
                                value={selectedTraveler}
                                onChange={(e) => setSelectedTraveler(e.target.value)}
                                className="p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 w-full md:w-1/3"
                            >
                                <option value="">-- Select Traveler for Bill --</option>
                                {confirmedTravelers.map(t => (
                                    <option key={t.id} value={t.name}>{t.name}</option>
                                ))}
                            </select>
                            <button
                                onClick={handlePrint}
                                disabled={!selectedTraveler}
                                className={`px-4 py-2 rounded-md text-sm font-semibold ${selectedTraveler ? 'bg-blue-600 text-white hover:bg-blue-700' : 'bg-gray-300 text-gray-500 cursor-not-allowed'}`}
                            >
                                Print Bill
                            </button>
                        </div>
                        
                        {selectedTraveler && (
                            <div ref={componentRef} className="p-4 bg-white rounded-lg border-2 border-indigo-200">
                                <h4 className="text-2xl font-bold text-indigo-700 mb-4">Trip Bill for {travelerName}</h4>
                                
                                {/* Summary Box */}
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 border-b pb-4 mb-4">
    <div className="bg-green-50 p-3 rounded-md">
        <p className="text-xs text-green-700 font-medium">Total Paid (Contribution)</p>
        <p className="text-lg md:text-xl font-bold text-green-900">‚Çπ{totalPaid.toFixed(2)}</p>
    </div>
    <div className="bg-red-50 p-3 rounded-md">
        <p className="text-xs text-red-700 font-medium">Total Share (Owed by Traveler)</p>
        <p className="text-lg md:text-xl font-bold text-red-900">‚Çπ{totalOwedShare.toFixed(2)}</p>
    </div>
    <div className={`p-3 rounded-md ${netBalance >= 0 ? 'bg-indigo-100' : 'bg-orange-100'}`}>
        <p className={`text-xs ${netBalance >= 0 ? 'text-indigo-700' : 'text-orange-700'} font-medium`}>
            Net Balance ({netBalance >= 0 ? 'Refund Due' : 'Payment Due'})
        </p>
        <p className="text-xl md:text-2xl font-extrabold text-indigo-900 break-words">
            {netBalance >= 0 ? '+' : '-'} ‚Çπ{Math.abs(netBalance).toFixed(2)}
        </p>
    </div>
</div>

                                {/* Details Table */}
                                <h5 className="font-semibold text-lg mb-2 text-gray-700">Detailed Contributions (Paid By {travelerName})</h5>
                                <table className="min-w-full text-sm mb-4">
                                    <thead>
                                        <tr className="bg-gray-100">
                                            <th className="px-3 py-2 text-left">Date</th>
                                            <th className="px-3 py-2 text-left">Description</th>
                                            <th className="px-3 py-2 text-right">Amount Paid</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {travelerExpensesPaid.length > 0 ? travelerExpensesPaid.map(exp => (
                                            <tr key={exp.id} className="border-b">
                                                <td className="px-3 py-2">{exp.date}</td>
                                                <td className="px-3 py-2">{exp.description} ({exp.splitType} Split)</td>
                                                <td className="px-3 py-2 text-right">‚Çπ{exp.amount.toFixed(2)}</td>
                                            </tr>
                                        )) : (
                                            <tr><td colSpan="3" className="px-3 py-2 text-center text-gray-500">No confirmed contributions recorded.</td></tr>
                                        )}
                                    </tbody>
                                </table>
                                
                                <p className="text-xs text-gray-500 mt-4">Note: The total share (‚Çπ{totalOwedShare.toFixed(2)}) is {travelerName}'s equal share of all confirmed 'Equal Split' expenses.</p>
                            </div>
                        )}
                    </div>
                );
            };

            const TabButton = ({ name, label }) => (
                <button
                    className={`px-4 py-2 text-sm font-medium focus:outline-none ${
                        activeTab === name
                            ? 'border-b-2 border-blue-500 text-blue-600'
                            : 'text-gray-600 hover:text-gray-800'
                    }`}
                    onClick={() => setActiveTab(name)}
                >
                    {label}
                </button>
            );

            const TravelerCard = ({ traveler }) => (
                <div className="bg-white rounded-lg shadow p-4 flex flex-col md:flex-row items-start md:items-center justify-between space-y-2 md:space-y-0 md:space-x-4">
                    <div className="flex-grow">
                        <div className="flex items-center space-x-2 mb-1">
                            <span className="font-bold text-gray-800">{traveler.name}</span>
                            <span className="text-sm text-gray-500">
                                {traveler.transport === 'Plane' ? '‚úàÔ∏è' : 'üöÜ'}
                            </span>
                            <span className={`px-2 py-1 rounded-full text-xs font-semibold ${getStatusColor(traveler.status)}`}>
                                {traveler.status}
                            </span>
                        </div>
                        <div className="text-xs text-gray-600">
                            Arrival: {traveler.arrival}, Departure: {traveler.departure}
                        </div>
                    </div>
                    <div className="flex space-x-2">
                           <select
                                className={`px-2 py-1 rounded-md border text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${getStatusColor(traveler.status)}`}
                                value={traveler.status}
                                onChange={(e) => updateTravelerStatus(traveler.id, e.target.value)}
                            >
                                <option value="Confirmed">Confirmed</option>
                                <option value="Pending">Pending</option>
                                <option value="Cancelled">Cancelled</option>
                            </select>
                        <button
                            onClick={() => deleteTraveler(traveler.id)}
                            className="text-red-500 hover:text-red-700 px-2 py-1 rounded-md bg-red-50 hover:bg-red-100 text-sm"
                        >
                            Delete
                        </button>
                    </div>
                </div>
            );

            const AddTravelerForm = () => {
                const today = getFormattedDate();
                const defaultDeparture = getFormattedDate(new Date(new Date().setDate(new Date().getDate() + 5)));
                const [name, setName] = useState('');
                const [transport, setTransport] = useState('Plane');
                const [arrival, setArrival] = useState(today);
                const [departure, setDeparture] = useState(defaultDeparture);
                const [status, setStatus] = useState('Confirmed');

                const handleSubmit = (e) => {
                    e.preventDefault();
                    if (!name) return;
                    addTraveler({ name, transport, arrival, departure, status });
                    setName('');
                    setArrival(today);
                    setDeparture(defaultDeparture);
                    setStatus('Confirmed');
                };

                return (
                    <form onSubmit={handleSubmit} className="p-4 bg-blue-50 rounded-lg shadow-sm mb-4">
                        <h3 className="text-lg font-semibold mb-2 text-blue-700">Add New Traveler</h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-3">
                            <input
                                type="text"
                                placeholder="Traveler Name"
                                value={name}
                                onChange={(e) => setName(e.target.value)}
                                className="p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500"
                                required
                            />
                            <select
                                value={transport}
                                onChange={(e) => setTransport(e.target.value)}
                                className="p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500"
                            >
                                <option value="Plane">Plane</option>
                                <option value="Train">Train</option>
                            </select>
                            <input
                                type="text"
                                placeholder="Arrival Date (e.g., Nov 26)"
                                value={arrival}
                                onChange={(e) => setArrival(e.target.value)}
                                className="p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500"
                                required
                            />
                            <input
                                type="text"
                                placeholder="Departure Date (e.g., Dec 01)"
                                value={departure}
                                onChange={(e) => setDeparture(e.target.value)}
                                className="p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500"
                                required
                            />
                             <select
                                value={status}
                                onChange={(e) => setStatus(e.target.value)}
                                className="p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500"
                            >
                                <option value="Confirmed">Confirmed</option>
                                <option value="Pending">Pending</option>
                                <option value="Cancelled">Cancelled</option>
                            </select>
                        </div>
                        <button
                            type="submit"
                            className="w-full bg-blue-600 text-white p-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
                        >
                            Add Traveler
                        </button>
                    </form>
                );
            };

            const AddExpenseForm = () => {
                const [description, setDescription] = useState('');
                const [amount, setAmount] = useState('');
                const [splitType, setSplitType] = useState('Equal');
                const [paidBy, setPaidBy] = useState('');
                const [status, setStatus] = useState('Confirmed');

                const handleSubmit = (e) => {
                    e.preventDefault();
                    if (!description || !amount || !paidBy) return;
                    addExpense({
                        date: new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                        description,
                        amount: parseFloat(amount),
                        splitType,
                        paidBy,
                        status
                    });
                    setDescription('');
                    setAmount('');
                    setSplitType('Equal');
                    setPaidBy('');
                    setStatus('Confirmed');
                };

                return (
                    <form onSubmit={handleSubmit} className="p-4 bg-green-50 rounded-lg shadow-sm mb-4">
                        <h3 className="text-lg font-semibold mb-2 text-green-700">Add New Expense</h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-3">
                            <input
                                type="text"
                                placeholder="Description"
                                value={description}
                                onChange={(e) => setDescription(e.target.value)}
                                className="p-2 border rounded-md focus:ring-green-500 focus:border-green-500"
                                required
                            />
                            <input
                                type="number"
                                placeholder="Amount (e.g., 6000)"
                                value={amount}
                                onChange={(e) => setAmount(e.target.value)}
                                className="p-2 border rounded-md focus:ring-green-500 focus:border-green-500"
                                required
                            />
                            <select
                                value={splitType}
                                onChange={(e) => setSplitType(e.target.value)}
                                className="p-2 border rounded-md focus:ring-green-500 focus:border-green-500"
                            >
                                <option value="Equal">Equal Split</option>
                                <option value="Individual">Individual (Not Split)</option>
                                <option value="Custom">Custom Split (Advanced)</option>
                            </select>
                             <select
                                value={paidBy}
                                onChange={(e) => setPaidBy(e.target.value)}
                                className="p-2 border rounded-md focus:ring-green-500 focus:border-green-500"
                                required
                            >
                                <option value="">-- Paid By --</option>
                                {travelers.map(t => (
                                    <option key={t.id} value={t.name}>{t.name}</option>
                                ))}
                            </select>
                            <select
                                value={status}
                                onChange={(e) => setStatus(e.target.value)}
                                className="p-2 border rounded-md focus:ring-green-500 focus:border-green-500"
                            >
                                <option value="Confirmed">Confirmed</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                        <button
                            type="submit"
                            className="w-full bg-green-600 text-white p-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2"
                        >
                            Add Expense
                        </button>
                    </form>
                );
            };

            const TravelerList = () => (
                <div className="space-y-4">
                    <AddTravelerForm />
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        {travelers.map(traveler => (
                            <TravelerCard key={traveler.id} traveler={traveler} />
                        ))}
                    </div>
                </div>
            );

            const ExpenseCard = ({ expense }) => (
                <div className="bg-white rounded-lg shadow p-4 flex flex-col md:flex-row items-start md:items-center justify-between space-y-2 md:space-y-0 md:space-x-4">
                    <div className="flex-grow">
                        <div className="flex items-center space-x-2 mb-1">
                            <span className="font-bold text-gray-800">‚Çπ{expense.amount.toFixed(2)}</span>
                            <span className="text-sm text-gray-500">
                                {expense.description}
                            </span>
                            <span className={`px-2 py-1 rounded-full text-xs font-semibold ${getStatusColor(expense.status)}`}>
                                {expense.status}
                            </span>
                        </div>
                        <div className="text-xs text-gray-600">
                            Date: {expense.date} | Paid by: {expense.paidBy} | Split: {expense.splitType}
                        </div>
                    </div>
                    <div className="flex space-x-2">
                        <button
                            onClick={() => deleteExpense(expense.id)}
                            className="text-red-500 hover:text-red-700 px-2 py-1 rounded-md bg-red-50 hover:bg-red-100 text-sm"
                        >
                            Delete
                        </button>
                    </div>
                </div>
            );

            const ExpenseList = () => (
                <div className="space-y-4">
                    <AddExpenseForm />
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        {expenses.map(expense => (
                            <ExpenseCard key={expense.id} expense={expense} />
                        ))}
                    </div>
                </div>
            );

            const Content = () => {
                switch (activeTab) {
                    case 'travelers':
                        return <TravelerList />;
                    case 'expenses':
                        return <ExpenseList />;
                    case 'splits':
                        return (
                            <>
                                <ExpenseSplitCalculator />
                                <IndividualBillGenerator />
                            </>
                        );
                    default:
                        return <TravelerList />;
                }
            };

            return (
                <div className="min-h-screen bg-gray-100 p-4 md:p-8">
                    <div className="max-w-4xl mx-auto bg-white rounded-xl shadow-2xl p-6">
                        <h1 className="text-3xl font-extrabold text-gray-900 mb-6 border-b pb-4">
                            üåç Trip Manager
                        </h1>

                        <div className="flex border-b mb-6 no-print">
                            <TabButton name="travelers" label="üë• Travelers" />
                            <TabButton name="expenses" label="üí∏ Expenses" />
                            <TabButton name="splits" label="‚öñÔ∏è Splits & Bills" />
                        </div>

                        <div className="overflow-y-auto" style={{ maxHeight: '75vh' }}>
                            <Content />
                        </div>

                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>